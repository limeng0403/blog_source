<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>my theme</title>
  <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link type="text/css" href="/css/index.css" rel="stylesheet" />
</head>
<style type="text/css">

</style>
<body>
  <div class="container-fluid">
    <div class="row">
    <div class="col-sm-12">
        <div class="row box-wrapper">
            <div class="col-sm-2 box-date">
                <p>10</p>
                <p>04/2016</p>
            </div>
            <div class="col-sm-10 box-content">
                <h3>
                  <a href="/2016/04/10/Array.prototype.reduce函数/" target="_blank">
                    Array.prototype.reduce函数
                  </a>
                </h3>

                <p>
                  
                      javascript
                  
                </p>

                <h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>reduce() 方法接收一个函数作为累加器（accumulator），数组中的每个值（从左到右）开始合并，最终为一个值。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p><code>arr.reduce(callback,[initialValue])</code></p>
<p><strong>参数</strong></p>
<p><em>callback 执行数组中每个值的函数，包含四个参数</em></p>
<blockquote>
<p><em>previousValue</em><br>上一次调用回调返回的值，或者是提供的初始值（initialValue）<br><em>currentValue</em><br>数组中当前被处理的元素<br><em>index</em><br>当前元素在数组中的索引<br><em>array</em><br>调用 reduce 的数组<br><em>initialValue</em><br>作为第一次调用 callback 的第一个参数。</p>
</blockquote>
<h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>reduce 为数组中的每一个元素依次执行回调函数，不包括数组中被删除或从未被赋值的元素，接受四个参数：初始值（或者上一次回调函数的返回值），当前元素值，当前索引，调用 reduce 的数组。</p>
<p>回调函数第一次执行时，previousValue 和 currentValue 可以是一个值，如果 initialValue 在调用 reduce 时被提供，那么第一个 previousValue 等于 initialValue ，并且currentValue 等于数组中的第一个值；如果initialValue 未被提供，那么previousValue 等于数组中的第一个值，currentValue等于数组中的第二个值。</p>
<p>如果数组为空并且没有提供initialValue， 会抛出TypeError 。如果数组仅有一个元素（无论位置如何）并且没有提供initialValue， 或者有提供initialValue但是数组为空，那么此唯一值将被返回并且callback不会被执行。</p>
<p>例如执行下面的代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[0,1,2,3,4].reduce(function(previousValue, currentValue, index, array)&#123;</span><br><span class="line">  return previousValue + currentValue;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>回调被执行四次，每次的参数和返回值如下表：</p>
<table>
<thead>
<tr>
<th>previousValue</th>
<th>currentValue</th>
<th>index</th>
<th>array</th>
<th>return</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>first</td>
<td>call</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>[0,1,2,3,4]</td>
</tr>
<tr>
<td>second</td>
<td>call</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>[0,1,2,3,4]</td>
</tr>
<tr>
<td>third</td>
<td>call</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>[0,1,2,3,4]</td>
</tr>
<tr>
<td>fourth</td>
<td>call</td>
<td>6</td>
<td>4</td>
<td>4</td>
<td>[0,1,2,3,4]</td>
</tr>
</tbody>
</table>
<p>reduce 的返回值是回调函数最后一次被调用的返回值（10）。</p>
<p>如果把初始值作为第二个参数传入 reduce，最终返回值变为20，结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[0,1,2,3,4].reduce(function(previousValue, currentValue, index, array)&#123;</span><br><span class="line">  return previousValue + currentValue;</span><br><span class="line">&#125;, 10);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>previousValue</th>
<th>currentValue</th>
<th>index</th>
<th>array</th>
<th>return</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>第一次调用</td>
<td>10</td>
<td>0</td>
<td>0</td>
<td>[0,1,2,3,4]</td>
<td>10</td>
</tr>
<tr>
<td>第二次调用</td>
<td>10</td>
<td>1</td>
<td>1</td>
<td>[0,1,2,3,4]</td>
<td>11</td>
</tr>
<tr>
<td>第三次调用</td>
<td>11</td>
<td>2</td>
<td>2</td>
<td>[0,1,2,3,4]</td>
<td>13</td>
</tr>
<tr>
<td>第四次调用</td>
<td>13</td>
<td>3</td>
<td>3</td>
<td>[0,1,2,3,4]</td>
<td>16</td>
</tr>
<tr>
<td>第五次调用</td>
<td>16</td>
<td>4</td>
<td>4</td>
<td>[0,1,2,3,4]</td>
<td>20</td>
</tr>
</tbody>
</table>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>例子:将数组所有项相加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var total = [0, 1, 2, 3].reduce(function(a, b) &#123;</span><br><span class="line">    return a + b;</span><br><span class="line">&#125;);</span><br><span class="line">// total == 6</span><br></pre></td></tr></table></figure>
<p>例子: 数组扁平化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var flattened = [[0, 1], [2, 3], [4, 5]].reduce(function(a, b) &#123;</span><br><span class="line">    return a.concat(b);</span><br><span class="line">&#125;);</span><br><span class="line">// flattened is [0, 1, 2, 3, 4, 5]</span><br></pre></td></tr></table></figure>
<h3 id="兼容旧环境（Polyfill）"><a href="#兼容旧环境（Polyfill）" class="headerlink" title="兼容旧环境（Polyfill）"></a>兼容旧环境（Polyfill）</h3><p>Array.prototype.reduce 被添加到 ECMA-262 标准第 5 版；因此可能在某些实现环境中不被支持。可以将下面的代码插入到脚本开头来允许在那些未能原生支持 reduce 的实现环境中使用它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">if (&apos;function&apos; !== typeof Array.prototype.reduce) &#123;</span><br><span class="line">  Array.prototype.reduce = function(callback, opt_initialValue)&#123;</span><br><span class="line">    &apos;use strict&apos;;</span><br><span class="line">    if (null === this || &apos;undefined&apos; === typeof this) &#123;</span><br><span class="line">      // At the moment all modern browsers, that support strict mode, have</span><br><span class="line">      // native implementation of Array.prototype.reduce. For instance, IE8</span><br><span class="line">      // does not support strict mode, so this check is actually useless.</span><br><span class="line">      throw new TypeError(</span><br><span class="line">          &apos;Array.prototype.reduce called on null or undefined&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    if (&apos;function&apos; !== typeof callback) &#123;</span><br><span class="line">      throw new TypeError(callback + &apos; is not a function&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    var index, value,</span><br><span class="line">        length = this.length &gt;&gt;&gt; 0,</span><br><span class="line">        isValueSet = false;</span><br><span class="line">    if (1 &lt; arguments.length) &#123;</span><br><span class="line">      value = opt_initialValue;</span><br><span class="line">      isValueSet = true;</span><br><span class="line">    &#125;</span><br><span class="line">    for (index = 0; length &gt; index; ++index) &#123;</span><br><span class="line">      if (this.hasOwnProperty(index)) &#123;</span><br><span class="line">        if (isValueSet) &#123;</span><br><span class="line">          value = callback(value, this[index], index, this);</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">          value = this[index];</span><br><span class="line">          isValueSet = true;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (!isValueSet) &#123;</span><br><span class="line">      throw new TypeError(&apos;Reduce of empty array with no initial value&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">    return value;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="浏览器兼容性"><a href="#浏览器兼容性" class="headerlink" title="浏览器兼容性"></a>浏览器兼容性</h3><p><strong>Desktop</strong></p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Chrome</th>
<th>Firefox (Gecko)</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
</tr>
</thead>
<tbody>
<tr>
<td>Basic support</td>
<td>(Yes)</td>
<td>3.0(1.9)</td>
<td>9</td>
<td>10.5</td>
<td>4.0</td>
</tr>
</tbody>
</table>
<p><strong>Mobile</strong></p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Android</th>
<th>Chrome for Android</th>
<th>Firefox Mobile (Gecko)</th>
<th>IE Mobile</th>
<th>Opera Mobile</th>
<th>Safari Mobile</th>
</tr>
</thead>
<tbody>
<tr>
<td>Basic support</td>
<td>(Yes)</td>
<td>(Yes)</td>
<td>(Yes)</td>
<td>(Yes)</td>
<td>(Yes)</td>
<td>(Yes)</td>
</tr>
</tbody>
</table>

            </div>
        </div>
    </div>
</div>
  </div>
  <div class="footer">
  <p>感谢hexo(https://hexo.io)提供技术支持</p>
  <p>2010-2016</p>
  </div>
  <script src="https://cdn.bootcss.com/jquery/1.12.1/jquery.min.js"></script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
</body>

</html>
